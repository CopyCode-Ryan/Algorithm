<!DOCTYPE html>
<html lang="en">
<meta charset="utf8" />
<link rel="stylesheet" href="css/visual.css" />
<style>
    canvas {
        display: block;
        min-width: 1000px;
        min-height: 500px;
    }

    #cvs {
        background: #FFF;
    }
</style>

<body onload="init();" class="VisualMainPage">
    <div id="container">
        <div id="header">
            <h1>排序算法</h1>
        </div>
        <div id="mainContent">
            <div id="algoControlSection">
                <div id="AlgorithmSpecificControls">
                    <button id="random" class="btn">随机生成数据</button>
                    <div class="select">
                        <select id="algroithm">
                            <option value="1" selected>冒泡排序</option>
                            <option value="2">选择排序</option>
                        </select>
                    </div>
                    <button id="running" class="btn btn-primary">演示</button>
                </div>
            </div>
            <canvas id="canvas" width="1000" height="500"></canvas>
        </div>
    </div>
    <div id="footer">
        <p> COPYRIGHT 2020 可视化算法网. ALL RIGHTS RESERVED.</p>
    </div>
</body>
<script type="text/javascript" src="base.js"></script>
<script type="text/javascript">
    function init() {
        InitCanvas();
        random = document.getElementById('random');
        random.addEventListener('click', (event) => {
            clearAllTimeout();
            refreshCanvas();
        }, false);
        running = document.getElementById('running');
        algroithm = document.getElementById('algroithm');
        algroithm.addEventListener('change', (event) => {
            index = algroithm.selectedIndex;
            val = algroithm.options[index].value;
            clearAllTimeout();
            refreshCanvas();
        }, false);

        running.addEventListener('click', (event) => {
            index = algroithm.selectedIndex;
            val = algroithm.options[index].value;
            algroithm.setAttribute("disabled", true);
            random.setAttribute("disabled", true);
            running.setAttribute("disabled", true);
            Sort(val, function () {
                algroithm.removeAttribute("disabled");
                random.removeAttribute("disabled");
                running.removeAttribute("disabled");
            });
        }, false);
    }

    /*
        var cvs = document.getElementById('cvs');
        var ctx = cvs.getContext('2d');
        var lists = [32, 31, 29, 26, 20, 24, 35, 6, 25, 39, 13,
            33, 8, 38, 10, 18, 5, 3, 27, 21, 17, 34, 28, 14,
            12, 23, 7, 22, 16, 19, 37, 9, 2, 30, 11, 36, 4,
            15, 40, 1];
        //var lists = [1];
        var index = 0;      //延时函数计数
        //清空画布
        function clearCanvas() {
            ctx.clearRect(0, 0, cvs.width, cvs.height);
        }

        //绘柱状图，高亮交换位
        function draw(arr, first, second) {
            clearCanvas();
            for (var i in arr) {
                var x = 10 + 25 * i;
                var y = arr[i] * 10;
                ctx.beginPath();
                if (i == first)
                    ctx.fillStyle = 'yellow';
                else if (i == second)
                    ctx.fillStyle = 'yellow';
                else ctx.fillStyle = 'orange';
                ctx.fillRect(x, 480 - y - 10, 18, y);
                width = ctx.measureText(arr[i].toString()).width;
                ctx.fillText(arr[i], x + (15 - width) / 2, 480);
                ctx.closePath();
            }
        }
        //完整复制数组
        function cpy(arr) {
            var item = [];
            for (var i in arr) {
                item[i] = arr[i];
            }
            return item;
        }

        //交换数据时延时画图，高亮交换位
        function swap(items, firstIndex, secondIndex) {
            //交换数据
            var temp = items[firstIndex];
            items[firstIndex] = items[secondIndex];
            items[secondIndex] = temp;
            //延时画图
            var ls = cpy(items);
            setTimeout(function () {
                draw(ls, firstIndex, secondIndex);
            }, index * 100);
            index++;
        }

        function partition(items, left, right) {
            var pivot = items[Math.floor((right + left) / 2)],
                i = left,
                j = right;
            while (i <= j) {
                while (items[i] < pivot) {
                    i++;
                }
                while (items[j] > pivot) {
                    j--;
                }
                if (i <= j) {
                    swap(items, i, j);
                    i++;
                    j--;
                }
            }
            return i;
        }

        function quickSort(items, left, right) {
            var index;
            if (items.length > 1) {
                index = partition(items, left, right);
                if (left < index - 1) {
                    quickSort(items, left, index - 1);
                }
                if (index < right) {
                    quickSort(items, index, right);
                }

            }
            return items;
        }
        function start() {
            draw(lists);            //开始绘图
            var arr = cpy(lists);   //复制数组，下次可以重新开始动画
            index = 0;              //初始化延时计数
            quickSort(arr, 0, arr.length - 1);    //执行快排
            setTimeout(function () {  //结束绘图
                draw(arr);
            }, index * 100);
        }
        */
</script>

</html>